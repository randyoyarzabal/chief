# Chief v3.1.1 Release Notes

## ğŸš€ What's New in v3.1.1

### ğŸ”§ Function Naming Convention Standardization

All plugin functions now use consistent hyphen notation following the pattern `chief.<plugin>_<word>-<word>` for better readability and consistency across the entire codebase.

### ğŸ†• New SSL Renewal Feature

- **`chief.ssl_renew-tls-cert`** - Smart certificate renewal with automatic parameter extraction
  - Auto-detects CA from existing certificate issuer
  - Preserves all original certificate parameters (Subject, SAN, extensions)
  - Expiry checking and validation (`--check-expiry`)
  - Optional backup creation (`--backup`)
  - New key generation support (`--new-key`)
  - Force renewal option (`--force`)

## ğŸ”¥ BREAKING CHANGES

**Function Naming Convention Standardization (34 functions renamed)**  
All plugin functions now use consistent hyphen notation following the pattern `chief.<plugin>_<word>-<word>`:

### SSL Plugin (5 functions)

- `chief.ssl_create_ca` â†’ `chief.ssl_create-ca`
- `chief.ssl_create_tls_cert` â†’ `chief.ssl_create-tls-cert`
- `chief.ssl_view_cert` â†’ `chief.ssl_view-cert`
- `chief.ssl_get_cert` â†’ `chief.ssl_get-cert`
- **NEW:** `chief.ssl_renew-tls-cert` (certificate renewal)

### SSH Plugin (3 functions)

- `chief.ssh_rm_host` â†’ `chief.ssh_rm-host`
- `chief.ssh_get_publickey` â†’ `chief.ssh_get-publickey`
- `chief.ssh_create_keypair` â†’ `chief.ssh_create-keypair`

### Python Plugin (4 functions)

- `chief.python_ve_dep` â†’ `chief.python_ve-dep`
- `chief.python_create_ve` â†’ `chief.python_create-ve`
- `chief.python_start_ve` â†’ `chief.python_start-ve`
- `chief.python_stop_ve` â†’ `chief.python_stop-ve`

### OpenShift Plugin (6 functions)

- `chief.oc_get_all_objects` â†’ `chief.oc_get-all-objects`
- `chief.oc_clean_olm` â†’ `chief.oc_clean-olm`
- `chief.oc_clean_replicasets` â†’ `chief.oc_clean-replicasets`
- `chief.oc_approve_csrs` â†’ `chief.oc_approve-csrs`
- `chief.oc_show_stuck_resources` â†’ `chief.oc_show-stuck-resources`
- `chief.oc_delete_stuck_ns` â†’ `chief.oc_delete-stuck-ns`

### Git Plugin (7 functions)

- `chief.git_rename_branch` â†’ `chief.git_rename-branch`
- `chief.git_delete_tag` â†’ `chief.git_delete-tag`
- `chief.git_delete_branch` â†’ `chief.git_delete-branch`
- `chief.git_cred_cache` â†’ `chief.git_cred-cache`
- `chief.git_set_url` â†’ `chief.git_set-url`
- `chief.git_config_user` â†’ `chief.git_config-user`

### Etc Plugin (8 functions)

- `chief.etc_create_bootusb` â†’ `chief.etc_create-bootusb`
- `chief.etc_copy_dotfiles` â†’ `chief.etc_copy-dotfiles`
- `chief.etc_create_cipher` â†’ `chief.etc_create-cipher`
- `chief.etc_mount_share` â†’ `chief.etc_mount-share`
- `chief.etc_folder_diff` â†’ `chief.etc_folder-diff`
- `chief.etc_at_run` â†’ `chief.etc_at-run`
- `chief.etc_isvalid_ip` â†’ `chief.etc_isvalid-ip`
- `chief.etc_folder_sync` â†’ `chief.etc_folder-sync`
- `chief.etc_ask_yes_or_no` â†’ `chief.etc_ask-yes-or-no`
- `chief.type_writer` â†’ `chief.type-writer`

### AWS Plugin (2 functions)

- `chief.aws_set_role` â†’ `chief.aws_set-role`
- `chief.aws_export_creds` â†’ `chief.aws_export-creds`

## ğŸ“‹ Migration Guide

**Update Required:** All scripts, aliases, or documentation that reference the old underscore notation must be updated to use the new hyphen notation.

**Pattern:** The new convention matches existing functions like `chief.vault_file-edit` for consistency across all plugins.

**Examples:**

```bash
# OLD (will not work)
chief.ssl_create_ca mycompany
chief.python_start_ve myproject
chief.oc_get_all_objects mynamespace

# NEW (correct syntax)
chief.ssl_create-ca mycompany  
chief.python_start-ve myproject
chief.oc_get-all-objects mynamespace
```

## ğŸ› ï¸ Technical Improvements

### Test Suite Enhancements

- **Fixed plugin function detection** - Updated regex patterns to properly detect functions with hyphens
- **Improved test output** - Suppressed unnecessary "Failed: 0" messages when all tests pass
- **Enhanced function discovery** - Resolved "No functions/aliases found: vault" warnings

### Documentation Updates

- **Comprehensive reference updates** - All plugin summaries, examples, and cross-references updated
- **Consistent naming throughout** - README.md, docs/index.md, and release notes all use new naming
- **Updated usage examples** - All function calls in documentation use new hyphen convention

## ğŸ”§ Post-Release Fixes (Re-release)

### Completed Implementation Issues

- **Issue**: Original v3.1.1 release had incomplete implementation of naming convention changes
- **Impact**: `chief.bash_profile`, `chief.bashrc`, `chief.profile` functions were broken with "command not found" errors
- **Root Cause**: Function definitions were updated but internal function calls still used old underscore naming
- **Fix Applied**: Updated all missed function calls to use correct hyphen naming convention
- **Functions Restored**: All shell configuration editing functions now work correctly

### Remote Plugins Update Process Fixed

- **Issue**: `chief.plugins_update` would create directory structure before validating git access, leading to orphaned directories when access failed
- **Impact**: Users with invalid repository URLs or access issues would get "directory already exists" errors on subsequent attempts
- **Solution**: 
  - Added git access validation **before** any filesystem changes using `git ls-remote`
  - Implemented automatic backup of existing local `~/chief_plugins` directories with timestamps
  - Reordered operations to validate â†’ backup â†’ create â†’ clone for safer execution
- **Benefits**:
  - Early failure detection prevents orphaned directories
  - Local plugin work is automatically preserved with timestamped backups
  - Clear error messages guide users to resolve access issues
  - No more "directory already exists" clone failures

### Improved Warning Message Handling
- **Issue**: Nagging "Remote plugins are not set to auto-update" warning appeared even when verbose output was disabled
- **Impact**: Users with intentionally quiet configurations (verbose=false) still saw unwanted warnings  
- **Fix Applied**: Warning now respects `CHIEF_CFG_VERBOSE` setting and only appears when verbose output is enabled
- **Improvement**: Added "Warning:" prefix to make the message less alarming and more informative

---

**Status:** Released  
**Release Date:** v3.1.1  
**Breaking Changes:** Yes - Function naming convention (migration required)  
**New Features:** SSL certificate renewal functionality
